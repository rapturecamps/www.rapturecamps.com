---
interface Props {
  block: any;
}

const { block } = Astro.props;
const bg = block.background === "dark-lighter" ? "bg-dark-lighter" : "bg-dark";
const heading = block.heading || "Surf Spots Nearby";
const subtext = block.subtext || block.subtitle || "We rotate between 15+ breaks depending on conditions. Here are some of the highlights.";
const spots = block.spots || block.surfSpots || [];
const fallbackImages = [
  "https://images.unsplash.com/photo-1502933691298-84fc14542831?w=600&h=400&fit=crop",
  "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=600&h=400&fit=crop",
  "https://images.unsplash.com/photo-1518548419970-58e3b4079ab2?w=600&h=400&fit=crop",
];

function getSpotImage(spot: any, i: number): string {
  const url = spot.image?.asset?.url || spot.image;
  return url || fallbackImages[i % fallbackImages.length];
}
---

<section class:list={["py-16 sm:py-20", bg]}>
  <div class="px-6 sm:px-12 lg:px-20">
    <h2 class="text-2xl sm:text-3xl lg:text-4xl font-semibold text-white mb-3">{heading}</h2>
    <p class="text-base text-white/45 max-w-3xl leading-relaxed mb-10">{subtext}</p>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      {spots.map((spot: any, i: number) => (
        <div class="rounded-xl overflow-hidden border border-white/5 bg-dark-lighter hover:border-white/10 transition-colors group">
          <div class="aspect-[3/2] overflow-hidden">
            <img
              src={getSpotImage(spot, i)}
              alt={spot.name || "Surf spot"}
              class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
              loading="lazy"
            />
          </div>
          <div class="p-5">
            <h3 class="text-base font-semibold text-white mb-2">{spot.name}</h3>
            <div class="flex gap-2 mb-3">
              {spot.level && (
                <span class="text-ocean-light bg-ocean-light/10 text-[10px] font-semibold uppercase tracking-wider rounded-full px-2.5 py-0.5">
                  {spot.level}
                </span>
              )}
              {spot.type && (
                <span class="text-white/30 bg-white/5 text-[10px] uppercase tracking-wider rounded-full px-2.5 py-0.5">
                  {spot.type}
                </span>
              )}
            </div>
            {spot.description && (
              <p class="text-sm text-white/50 leading-relaxed">{spot.description}</p>
            )}
          </div>
        </div>
      ))}
    </div>
  </div>
</section>
