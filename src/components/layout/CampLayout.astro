---
import BaseLayout from "@/layouts/BaseLayout.astro";
import Hero from "@/components/sections/Hero.astro";
import Breadcrumbs from "@/components/Breadcrumbs.astro";
import CampSubnav from "./CampSubnav.astro";

interface SpecialOffer {
  headline: string;
  body: string;
  ctaText: string;
  ctaHref: string;
  image?: string;
  voucherCode?: string;
  expiresAt?: string;
}

interface Props {
  campName: string;
  countryName: string;
  basePath: string;
  activePage: "overview" | "surf" | "rooms" | "food";
  bookingUrl: string;
  heroImage?: string;
  heroImages?: string[];
  heroTitle?: string;
  heroSubtitle?: string;
  heroTagline?: string;
  title?: string;
  description?: string;
  showWheel?: boolean;
  specialOffer?: SpecialOffer;
  disablePopups?: boolean;
}

const {
  campName,
  countryName,
  basePath,
  activePage,
  bookingUrl,
  heroImage = "https://images.unsplash.com/photo-1504681869696-d977211a5f4c?w=1920&h=1080&fit=crop",
  heroImages,
  heroTitle: heroTitleOverride,
  heroSubtitle: heroSubtitleOverride,
  heroTagline: heroTaglineOverride,
  title = `Rapture Surf Camp ${campName} | Rapture Surfcamps`,
  description = `Experience the best surf camp at ${campName}. Daily surf lessons, yoga, delicious food, and unforgettable vibes.`,
  showWheel,
  specialOffer,
  disablePopups,
} = Astro.props;

const countrySlug = basePath.split("/")[2];

const pageLabels: Record<string, string> = {
  overview: "The Surfcamp",
  surf: "Surf",
  rooms: "Rooms",
  food: "Food",
};
const pageLabel = pageLabels[activePage] || "";
const defaultTitle = activePage === "overview"
  ? `Rapture Surf Camp\n${campName}`
  : pageLabel;
const heroTitle = heroTitleOverride || defaultTitle;
const heroSubtitle = heroSubtitleOverride;
const heroTagline = heroTaglineOverride;
---

<BaseLayout title={title} description={description} ogImage={heroImage} bookingUrl={bookingUrl} showWheel={showWheel} specialOffer={specialOffer} disablePopups={disablePopups} preloadImage={heroImages?.[0] || heroImage}>
  <Hero
    title={heroTitle}
    subtitle={heroSubtitle}
    tagline={heroTagline}
    backgroundImage={heroImage}
    backgroundImages={heroImages}
  >
    <Breadcrumbs inline crumbs={[
      { label: "Surf Camps", href: "/surfcamp" },
      { label: countryName, href: `/surfcamp/${countrySlug}` },
      { label: campName, href: activePage === "overview" ? undefined : basePath },
      ...(activePage !== "overview" ? [{ label: pageLabel }] : []),
    ]} />
  </Hero>

  <CampSubnav
    campName={campName}
    basePath={basePath}
    activePage={activePage}
    bookingUrl={bookingUrl}
  />

  <slot />
</BaseLayout>
