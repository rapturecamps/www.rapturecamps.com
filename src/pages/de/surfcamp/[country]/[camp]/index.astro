---
import CampLayout from "@/components/layout/CampLayout.astro";
import CTASection from "@/components/sections/CTASection.astro";
import ImageBreak from "@/components/sections/ImageBreak.astro";
import ImageGrid from "@/components/sections/ImageGrid.astro";
import VideoTestimonials from "@/components/sections/VideoTestimonials.astro";
import ElfsightReviews from "@/components/sections/ElfsightReviews.astro";
import VideoBlock from "@/components/sections/VideoBlock.astro";
import ImageCarousel from "@/components/sections/ImageCarousel.astro";
import { getDestinations, getCampBySlug } from "@/lib/sanity-data";
import { t } from "@/lib/i18n";

const lang = "de";

const inclusionIcons: Record<string, string> = {
  "Surf guiding": "M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2s2.4 2 5 2c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2s2.4 2 5 2c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",
  "3 Course Breakfast": "M17 8h1a4 4 0 1 1 0 8h-1M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z M6 2v4 M10 2v4 M14 2v4",
  "Delicious Dinner": "M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2M7 2v20M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",
  "Free Flow Coffee & Tea": "M17 8h1a4 4 0 1 1 0 8h-1M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z M6 2v4 M10 2v4 M14 2v4",
  "Surf theory class": "M22 10v6M2 10l10-5 10 5-10 5z M6 12v5c6 5 6.9 3.6 12 0v-5",
  "Beach Transfer": "M8 6v6h7M15.5 17a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM5.5 17a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z M3 12h1 M16 12h5",
  "Video Analysis": "M23 7l-7 5 7 5V7z M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z",
  "WIFI": "M5 12.55a11 11 0 0 1 14.08 0M1.42 9a16 16 0 0 1 21.16 0M8.53 16.11a6 6 0 0 1 6.95 0M12 20h.01",
  "Yoga for Surfers": "M18 8a6 6 0 0 1-6 6 6 6 0 0 1-6-6 M6.34 17.66 4 22 M17.66 17.66 20 22",
};

const defaultInclusions = [
  { title: "Surf guiding", description: "Gegen Aufpreis" },
  { title: "3 Course Breakfast", description: "Reichhaltiges Frühstück" },
  { title: "Delicious Dinner", description: "Montag-Freitag" },
  { title: "Free Flow Coffee & Tea", description: "Zum Frühstück" },
  { title: "Surf theory class", description: "Alle Grundlagen lernen" },
  { title: "Beach Transfer", description: "Täglich" },
  { title: "Video Analysis", description: "Wöchentlich" },
  { title: "WIFI", description: "Kostenlos" },
  { title: "Yoga for Surfers", description: "Täglich" },
];

export async function getStaticPaths() {
  const allCamps = await getDestinations("de");
  return allCamps.map((d) => {
    const parts = d.slug.replace("/surfcamp/", "").split("/");
    return { params: { country: parts[0], camp: parts[1] } };
  });
}

const { country, camp } = Astro.params;
const campData = await getCampBySlug(camp!, lang);
if (!campData) return Astro.redirect("/de");
const campTitle = campData.name || camp!.split("-").map((w: string) => w.charAt(0).toUpperCase() + w.slice(1)).join(" ");
const countryTitle = country!.split("-").map((w: string) => w.charAt(0).toUpperCase() + w.slice(1)).join(" ");
const bookingUrl = campData.bookingUrl || `https://bookings.rapturecamps.com/de/product/${country}-${camp}-surf-stay`;
const basePath = `/de/surfcamp/${country}/${camp}`;
const rating = campData.rating || 4.7;
const reviewCount = campData.reviewCount || 100;
const tagline = campData.tagline || "Dein Zuhause fern von zuhause, direkt am Strand";

const highlights = [
  {
    title: "Weltklasse-Surf",
    desc: "15+ Breaks in Reichweite, von sanften Beachbreaks bis hin zu kraftvollen Riffwellen. Tägliche geführte Sessions mit ISA-zertifizierten Instruktoren.",
    icon: "M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2s2.4 2 5 2c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",
  },
  {
    title: "Fantastisches Essen",
    desc: "Drei-Gänge-Frühstück und Abendessen, täglich frisch zubereitet von unseren Köchen. Lokale Zutaten, internationale Aromen, jede Ernährungsform berücksichtigt.",
    icon: "M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2M7 2v20M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",
  },
  {
    title: "Komfortable Zimmer",
    desc: "Von geselligen Mehrbettzimmern bis hin zu privaten Suiten mit Meerblick. Jede Option beinhaltet alle Mahlzeiten, Surf und Yoga.",
    icon: "M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z M9 22V12h6v10",
  },
  {
    title: "Yoga & Wellness",
    desc: "Tägliche Yoga-Sessions, Post-Surf-Stretching und optionale Massagen. Dein Körper wird es dir danken.",
    icon: "M18 8a6 6 0 0 1-6 6 6 6 0 0 1-6-6 M6.34 17.66 4 22 M17.66 17.66 20 22",
  },
  {
    title: "Community & Vibes",
    desc: "Triff Surfer aus aller Welt. Sonnenuntergangs-Biere, Filmabende, Beach-BBQs — die Rapture-Community bringt die Leute immer wieder zurück.",
    icon: "M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2 M23 21v-2a4 4 0 0 0-3-3.87 M16 3.13a4 4 0 0 1 0 7.75 M9 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z",
  },
  {
    title: "Epische Lage",
    desc: `${campData.location || "Direkt an der Küste"} — nah genug an den besten Breaks, weit genug von den Massen für echtes Retreat-Feeling.`,
    icon: "M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z M12 7a3 3 0 1 0 0 6 3 3 0 0 0 0-6z",
  },
];

const subPages = [
  {
    title: "Surfen",
    href: `${basePath}/surf`,
    desc: "Entdecke die lokalen Breaks, Surfkurse und wie ein typischer Surftag aussieht.",
    image: "https://images.unsplash.com/photo-1502933691298-84fc14542831?w=600&h=400&fit=crop",
    icon: "M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2s2.4 2 5 2c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2s2.4 2 5 2c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",
  },
  {
    title: "Zimmer",
    href: `${basePath}/rooms`,
    desc: "Mehrbettzimmer, private Suiten, Glamping-Zelte — finde deine perfekte Unterkunft.",
    image: "https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=600&h=400&fit=crop",
    icon: "M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z M9 22V12h6v10",
  },
  {
    title: "Essen",
    href: `${basePath}/food`,
    desc: "Frische Mahlzeiten, wöchentliche Menüs und wie wir jede Ernährungsform berücksichtigen.",
    image: "https://images.unsplash.com/photo-1504754524776-8f4f37790ca0?w=600&h=400&fit=crop",
    icon: "M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z M6 1v3 M10 1v3 M14 1v3",
  },
];

const videoTestimonials = [
  {
    name: "Marco",
    date: "22.08.2025",
    location: "Bali Green Bowl",
    quote: "Ich habe in einer Woche surfen gelernt.",
    posterImage: "https://images.unsplash.com/photo-1539635278303-d4002c07eae3?w=400&h=620&fit=crop",
  },
  {
    name: "Fabiola",
    date: "15.06.2024",
    location: "Portugal Ericeira",
    quote: "Die beste Erfahrung meines Lebens, ehrlich.",
    posterImage: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=400&h=620&fit=crop",
  },
  {
    name: "Jonas",
    date: "03.09.2025",
    location: "Costa Rica Avellanas",
    quote: "Besser hätte es nicht sein können.",
    posterImage: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=620&fit=crop",
  },
  {
    name: "Lina",
    date: "28.07.2025",
    location: "Morocco Banana Village",
    quote: "Die Vibes, die Wellen, die Leute — pure Magie.",
    posterImage: "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=400&h=620&fit=crop",
  },
  {
    name: "Tom",
    date: "11.04.2025",
    location: "Nicaragua Maderas",
    quote: "Eine Woche geplant, drei geblieben.",
    posterImage: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=400&h=620&fit=crop",
  },
  {
    name: "Amelie",
    date: "19.01.2025",
    location: "Bali Padang Padang",
    quote: "Ich habe meinen Happy Place gefunden. Komme nächstes Jahr wieder.",
    posterImage: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=400&h=620&fit=crop",
  },
];
---

<CampLayout
  campName={campTitle}
  countryName={countryTitle}
  basePath={basePath}
  activePage="overview"
  bookingUrl={bookingUrl}
  heroImages={campData?.heroImages}
  heroTitle={campData?.heroTitle}
  heroSubtitle={campData?.heroSubtitle}
  heroTagline={campData?.heroTagline}
>
  <section class="py-16 sm:py-20 bg-dark">
    <div class="px-6 sm:px-12 lg:px-20">
      <div class="grid grid-cols-1 lg:grid-cols-5 gap-10 lg:gap-16 items-start">
        <div class="lg:col-span-3">
          <p class="text-sm text-ocean-light font-medium mb-4">{campData?.location || countryTitle}</p>
          <h1 class="text-2xl sm:text-3xl lg:text-4xl font-semibold text-white mb-6">{tagline}</h1>
          <div class="text-base sm:text-lg text-white/50 leading-relaxed space-y-4 max-w-2xl">
            <p>Rapture Surf Camp {campTitle} ist mehr als nur ein Surfcamp — es ist eine Gemeinschaft von Ozean-Liebhabern, ein Ort zum Abschalten und um sich auf das Wesentliche zu besinnen. Ob du zum ersten Mal auf einem Surfbrett stehst oder deinen tausendsten Barrel jagst — hier passiert es.</p>
            <p>Gelegen in {countryTitle}s berühmtester Surfregion bietet unser Camp tägliche Surfstunden, Yoga, fantastisches Essen und eine Crew von Gleichgesinnten aus aller Welt. Wir machen das seit 2003 — und haben alles perfektioniert.</p>
          </div>
        </div>
        <div class="lg:col-span-2">
          <div class="rounded-xl border border-white/5 bg-dark-lighter p-6 sm:p-8">
            <div class="flex items-center gap-3 mb-5">
              <div class="flex items-center gap-1">
                {[1,2,3,4,5].map((star) => (
                  <svg class:list={["h-4 w-4", star <= Math.round(rating) ? "text-amber-400" : "text-white/10"]} viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                ))}
              </div>
              <span class="text-sm text-white font-semibold">{rating}</span>
              <span class="text-xs text-white/30">({reviewCount} Bewertungen)</span>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center border-b border-white/5 pb-3">
                <span class="text-sm text-white/40">Standort</span>
                <span class="text-sm text-white font-medium">{campData?.location || countryTitle}</span>
              </div>
              <div class="flex justify-between items-center border-b border-white/5 pb-3">
                <span class="text-sm text-white/40">Surf-Level</span>
                <span class="text-sm text-white font-medium">Alle Level</span>
              </div>
              <div class="flex justify-between items-center border-b border-white/5 pb-3">
                <span class="text-sm text-white/40">Mindestaufenthalt</span>
                <span class="text-sm text-white font-medium">3 Nächte</span>
              </div>
              <div class="flex justify-between items-center border-b border-white/5 pb-3">
                <span class="text-sm text-white/40">Gruppengröße</span>
                <span class="text-sm text-white font-medium">Max 5:1 Ratio</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-white/40">Sprachen</span>
                <span class="text-sm text-white font-medium">DE, EN, PT, ES</span>
              </div>
            </div>
            <a
              href={bookingUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="book-link mt-6 flex w-full items-center justify-center rounded-full bg-ocean px-6 py-3 text-sm font-semibold text-white hover:bg-ocean-light transition-colors"
            >
              Verfügbarkeit prüfen
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <ImageGrid
    images={[
      { src: "https://images.unsplash.com/photo-1559628233-100c798642d4?w=1200&h=500&fit=crop", alt: `Camp Bereich ${campTitle}` },
      { src: "https://images.unsplash.com/photo-1540979388789-6cee28a1cdc9?w=600&h=450&fit=crop", alt: `Lounge Bereich ${campTitle}` },
      { src: "https://images.unsplash.com/photo-1582610116397-edb318620f90?w=600&h=225&fit=crop", alt: `Außenbereiche ${campTitle}` },
      { src: "https://images.unsplash.com/photo-1537996194471-e657df975ab4?w=600&h=225&fit=crop", alt: `Luftbild ${campTitle}` },
    ]}
    variant="collage"
  />

  <section class="py-16 sm:py-20 bg-dark">
    <div class="px-6 sm:px-12 lg:px-20">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-semibold text-white mb-3">Warum Rapture {campTitle}</h2>
      <p class="text-base text-white/40 mb-10 max-w-2xl">Das macht dieses Camp einzigartig — und warum unsere Gäste immer wiederkommen.</p>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
        {highlights.map((h) => (
          <div class="p-6 rounded-xl bg-dark-lighter border border-white/5">
            <div class="flex h-10 w-10 items-center justify-center rounded-lg bg-white/5 text-ocean-light mb-4">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d={h.icon} />
              </svg>
            </div>
            <h3 class="text-base font-semibold text-white mb-2">{h.title}</h3>
            <p class="text-sm text-white/40 leading-relaxed">{h.desc}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <VideoBlock
    type="youtube"
    src="gFiIesECPrA"
    title="Leben im Camp"
    description={`Ein Einblick in den Alltag im Rapture Surf Camp ${campTitle}.`}
    aspect="16:9"
    controls
    background="dark-lighter"
  />

  <ImageCarousel
    title={`${campTitle} Galerie`}
    description="Entdecke das Camp, den Surf und die Vibes."
    images={[
      { src: "https://images.unsplash.com/photo-1559628233-100c798642d4?w=1200&h=675&fit=crop", alt: `Surf-Session bei ${campTitle}`, caption: "Morgens surfen mit der Crew" },
      { src: "https://images.unsplash.com/photo-1540979388789-6cee28a1cdc9?w=1200&h=675&fit=crop", alt: `Entspannen im ${campTitle}`, caption: "Chillige Vibes in der Camp-Lounge" },
      { src: "https://images.unsplash.com/photo-1537996194471-e657df975ab4?w=1200&h=675&fit=crop", alt: `Luftbild bei ${campTitle}` },
      { src: "https://images.unsplash.com/photo-1504681869696-d977211a5f4c?w=1200&h=675&fit=crop", alt: `Sonnenuntergang surfen ${campTitle}`, caption: "Golden Hour im Line-Up" },
      { src: "https://images.unsplash.com/photo-1582610116397-edb318620f90?w=1200&h=675&fit=crop", alt: `Strand bei ${campTitle}`, caption: "Der Strand ist nur wenige Schritte entfernt" },
      { src: "https://images.unsplash.com/photo-1502933691298-84fc14542831?w=1200&h=675&fit=crop", alt: `Wellen bei ${campTitle}` },
    ]}
    aspect="16:9"
    background="dark"
  />

  <ImageBreak
    src="https://images.unsplash.com/photo-1504681869696-d977211a5f4c?w=1920&h=800&fit=crop"
    alt={`Sonnenuntergang surfen ${campTitle}`}
    caption={`Golden Hour in ${campTitle}, ${countryTitle}`}
    height="short"
  />

  <section class="py-16 sm:py-20 bg-dark">
    <div class="px-6 sm:px-12 lg:px-20">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-semibold text-white mb-3">Entdecke das Camp</h2>
      <p class="text-base text-white/40 mb-10 max-w-2xl">Tauche tiefer ein in das, was dich in {campTitle} erwartet.</p>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        {subPages.map((page) => (
          <a href={page.href} class="group rounded-xl overflow-hidden border border-white/5 bg-dark-lighter hover:border-white/10 transition-colors">
            <div class="aspect-[16/10] overflow-hidden">
              <img
                src={page.image}
                alt={page.title}
                class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
                loading="lazy"
              />
            </div>
            <div class="p-5">
              <div class="flex items-center gap-3 mb-2">
                <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-white/5 text-white/40">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d={page.icon} />
                  </svg>
                </div>
                <h3 class="text-base font-semibold text-white group-hover:text-ocean-light transition-colors">{page.title}</h3>
              </div>
              <p class="text-sm text-white/40 leading-relaxed">{page.desc}</p>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>

  <section class="py-16 sm:py-20 bg-dark-lighter">
    <div class="px-6 sm:px-12 lg:px-20">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-semibold text-white mb-3">Deine Buchung enthält immer</h2>
      <p class="text-base text-white/40 mb-10 max-w-2xl">Keine versteckten Kosten. Alles unten ist bei jeder Buchung in {campTitle} inklusive.</p>
      <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4">
        {defaultInclusions.map((item) => (
          <div class="flex flex-col items-center text-center p-5 rounded-xl bg-dark border border-white/5">
            <div class="flex h-10 w-10 items-center justify-center rounded-lg bg-ocean-light/10 text-ocean-light mb-3">
              <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d={inclusionIcons[item.title] || ""} />
              </svg>
            </div>
            <h3 class="text-xs font-semibold text-white">{item.title}</h3>
            <p class="mt-1 text-[10px] text-white/30">{item.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  {campData?.elfsightId && (
    <ElfsightReviews
      heading={`Was Gäste über ${campTitle} sagen`}
      appId={campData.elfsightId}
      schema={{
        businessName: `Rapture Surf Camp ${campTitle}`,
        ratingValue: campData.rating || 4.7,
        reviewCount: campData.reviewCount || 100,
        url: `https://www.rapturecamps.com${basePath}`,
      }}
    />
  )}

  <VideoTestimonials heading="Geschichten unserer Gäste" testimonials={videoTestimonials} />

  <section class="relative py-20 overflow-hidden bg-dark">
    <div class="absolute inset-0 bg-gradient-to-r from-ocean/20 to-dark"></div>
    <div class="relative z-10 mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-semibold text-white leading-tight">
        {t("cta.headline", lang)}
      </h2>
      <p class="mt-6 text-base text-white/50 max-w-2xl mx-auto">{t("cta.text", lang)}</p>
      <div class="mt-10 flex flex-col sm:flex-row gap-4 justify-center">
        <a
          href="https://bookings.rapturecamps.com"
          target="_blank"
          rel="noopener noreferrer"
          class="rounded-full bg-ocean px-8 py-3.5 text-sm font-semibold text-white transition-all hover:bg-ocean-light"
        >
          {t("cta.book", lang)}
        </a>
        <a
          href="/de/contact"
          class="rounded-full border border-white/20 px-8 py-3.5 text-sm font-semibold text-white transition-all hover:bg-white/10"
        >
          Kontakt aufnehmen
        </a>
      </div>
      <p class="mt-8 text-sm text-white/30">
        Fragen? Lies unsere <a href={`/de/faq/${camp}`} class="text-ocean-light hover:underline">FAQ</a>,
        stöbere im <a href={`/de/blog/category/${country}`} class="text-ocean-light hover:underline">Blog</a>,
        oder <a href="/de/contact" class="text-ocean-light hover:underline">schreib uns</a> direkt.
      </p>
    </div>
  </section>
</CampLayout>
